{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{ThemeProvider,useTheme}from'./contexts/ThemeContext';import ChatPage from'./pages/ChatPage';import AuthModal from'./components/AuthModal';import{useWebSocket}from'./hooks/useWebSocket';import'./styles/base.css';import'./styles/components.css';import'./styles/utilities.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function AppContent(){// 상태 관리\nconst[showAuthModal,setShowAuthModal]=useState(false);const[authType,setAuthType]=useState(null);const{isDarkMode,toggleTheme}=useTheme();const[user,setUser]=useState(null);const[userCount,setUserCount]=useState(0);// 웹소켓 커스텀 훅 사용\nconst{socket,showSessionExpiredModal,setShowSessionExpiredModal,chatBanTimeLeft,sendMessage}=useWebSocket(user);// 웹소켓 메시지 처리\nuseEffect(()=>{if(socket){const handleMessage=event=>{const data=JSON.parse(event.data);if(data.type==='user_count'){setUserCount(data.count);}// 다른 메시지 처리...\n};socket.addEventListener('message',handleMessage);return()=>{socket.removeEventListener('message',handleMessage);};}},[socket]);// 인증 모달 표시 함수\nconst handleAuthButton=type=>{setAuthType(type);setShowAuthModal(true);};// 모달 닫기 함수\nconst handleCloseModal=()=>{setShowAuthModal(false);setAuthType(null);};// 로그인 성공 처리 함수\nconst handleLoginSuccess=useCallback(userData=>{console.log('Login successful:',userData);setUser(userData);handleCloseModal();},[]);// 로그아웃 처리 함수\nconst handleLogout=()=>{setUser(null);setUserCount(0);if(socket){socket.close(1000,\"Logout\");}};// 세션 만료 처리 함수\nconst handleSessionExpired=()=>{setShowSessionExpiredModal(false);handleLogout();};return/*#__PURE__*/_jsxs(\"div\",{className:`App ${isDarkMode?'dark-mode':'light-mode'}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"main-section\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"main-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\uCC44\\uD305 \\uC560\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\"})}),/*#__PURE__*/_jsx(\"main\",{className:\"main-content\"})]}),/*#__PURE__*/_jsxs(\"aside\",{className:\"side-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"side-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-count\",children:[\"\\uD604\\uC7AC \\uC811\\uC18D\\uC790 \\uC218: \",userCount]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-buttons\",children:[user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"user-nickname\",children:[user.username,\"\\uB2D8\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-button\",children:\"\\uB85C\\uADF8\\uC544\\uC6C3\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAuthButton('login'),children:\"\\uB85C\\uADF8\\uC778\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAuthButton('register'),children:\"\\uD68C\\uC6D0\\uAC00\\uC785\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleTheme,className:\"theme-toggle\",children:isDarkMode?'라이트':'다크'})]})]}),/*#__PURE__*/_jsx(ChatPage,{socket:socket,user:user,chatBanTimeLeft:chatBanTimeLeft,sendMessage:sendMessage})]}),showAuthModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsx(AuthModal,{type:authType,onClose:handleCloseModal,onLoginSuccess:handleLoginSuccess})}),showSessionExpiredModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"session-expired-modal\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uB2E4\\uB978 \\uAE30\\uAE30\\uC5D0\\uC11C \\uB85C\\uADF8\\uC778\\uB418\\uC5B4 \\uB85C\\uADF8\\uC544\\uC6C3 \\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSessionExpired,children:\"\\uD655\\uC778\"})]})})]});}function App(){return/*#__PURE__*/_jsx(ThemeProvider,{children:/*#__PURE__*/_jsx(AppContent,{})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","ThemeProvider","useTheme","ChatPage","AuthModal","useWebSocket","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AppContent","showAuthModal","setShowAuthModal","authType","setAuthType","isDarkMode","toggleTheme","user","setUser","userCount","setUserCount","socket","showSessionExpiredModal","setShowSessionExpiredModal","chatBanTimeLeft","sendMessage","handleMessage","event","data","JSON","parse","type","count","addEventListener","removeEventListener","handleAuthButton","handleCloseModal","handleLoginSuccess","userData","console","log","handleLogout","close","handleSessionExpired","className","children","username","onClick","onClose","onLoginSuccess","App"],"sources":["/home/work/chat/front/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { ThemeProvider, useTheme } from './contexts/ThemeContext';\nimport ChatPage from './pages/ChatPage';\nimport AuthModal from './components/AuthModal';\nimport { useWebSocket } from './hooks/useWebSocket';\nimport './styles/base.css';\nimport './styles/components.css';\nimport './styles/utilities.css';\n\nfunction AppContent() {\n  // 상태 관리\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [authType, setAuthType] = useState(null);\n  const { isDarkMode, toggleTheme } = useTheme();\n  const [user, setUser] = useState(null);\n  const [userCount, setUserCount] = useState(0);\n\n  // 웹소켓 커스텀 훅 사용\n  const {\n    socket,\n    showSessionExpiredModal,\n    setShowSessionExpiredModal,\n    chatBanTimeLeft,\n    sendMessage\n  } = useWebSocket(user);\n\n  // 웹소켓 메시지 처리\n  useEffect(() => {\n    if (socket) {\n      const handleMessage = (event) => {\n        const data = JSON.parse(event.data);\n        if (data.type === 'user_count') {\n          setUserCount(data.count);\n        }\n        // 다른 메시지 처리...\n      };\n\n      socket.addEventListener('message', handleMessage);\n\n      return () => {\n        socket.removeEventListener('message', handleMessage);\n      };\n    }\n  }, [socket]);\n\n  // 인증 모달 표시 함수\n  const handleAuthButton = (type) => {\n    setAuthType(type);\n    setShowAuthModal(true);\n  };\n\n  // 모달 닫기 함수\n  const handleCloseModal = () => {\n    setShowAuthModal(false);\n    setAuthType(null);\n  };\n\n  // 로그인 성공 처리 함수\n  const handleLoginSuccess = useCallback((userData) => {\n    console.log('Login successful:', userData);\n    setUser(userData);\n    handleCloseModal();\n  }, []);\n\n  // 로그아웃 처리 함수\n  const handleLogout = () => {\n    setUser(null);\n    setUserCount(0);\n    if (socket) {\n      socket.close(1000, \"Logout\");\n    }\n  };\n\n  // 세션 만료 처리 함수\n  const handleSessionExpired = () => {\n    setShowSessionExpiredModal(false);\n    handleLogout();\n  };\n\n  return (\n    <div className={`App ${isDarkMode ? 'dark-mode' : 'light-mode'}`}>\n      <div className=\"main-section\">\n        <header className=\"main-header\">\n          <h1>채팅 애플리케이션</h1>\n        </header>\n        <main className=\"main-content\">\n          {/* 여기에 메인 콘텐츠가 들어갑니다 */}\n        </main>\n      </div>\n      <aside className=\"side-container\">\n        <header className=\"side-header\">\n          <div className=\"user-count\">현재 접속자 수: {userCount}</div>\n          <div className=\"header-buttons\">\n            {user ? (\n              <>\n                <span className=\"user-nickname\">{user.username}님</span>\n                <button onClick={handleLogout} className=\"logout-button\">로그아웃</button>\n              </>\n            ) : (\n              <>\n                <button onClick={() => handleAuthButton('login')}>로그인</button>\n                <button onClick={() => handleAuthButton('register')}>회원가입</button>\n              </>\n            )}\n            <button onClick={toggleTheme} className=\"theme-toggle\">\n              {isDarkMode ? '라이트' : '다크'}\n            </button>\n          </div>\n        </header>\n        <ChatPage \n          socket={socket} \n          user={user} \n          chatBanTimeLeft={chatBanTimeLeft}\n          sendMessage={sendMessage}\n        />\n      </aside>\n      {/* 인증 모달 */}\n      {showAuthModal && (\n        <div className=\"modal-backdrop\">\n          <AuthModal \n            type={authType} \n            onClose={handleCloseModal}\n            onLoginSuccess={handleLoginSuccess}\n          />\n        </div>\n      )}\n      {/* 세션 만료 모달 */}\n      {showSessionExpiredModal && (\n        <div className=\"modal-backdrop\">\n          <div className=\"session-expired-modal\">\n            <p>다른 기기에서 로그인되어 로그아웃 되었습니다.</p>\n            <button onClick={handleSessionExpired}>확인</button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction App() {\n  return (\n    <ThemeProvider>\n      <AppContent />\n    </ThemeProvider>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}