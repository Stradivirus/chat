{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ChatInput(_ref){let{onSendMessage,isLoggedIn}=_ref;const[message,setMessage]=useState('');const[isButtonDisabled,setIsButtonDisabled]=useState(false);const[isChatBanned,setIsChatBanned]=useState(false);const[banTimeLeft,setBanTimeLeft]=useState(0);const lastMessages=useRef([]);const banTimerRef=useRef(null);useEffect(()=>{return()=>{if(banTimerRef.current){clearInterval(banTimerRef.current);}};},[]);const handleSubmit=e=>{e.preventDefault();if(message.trim()&&message.length<=30&&isLoggedIn&&!isChatBanned){onSendMessage(message);lastMessages.current.push(message);if(lastMessages.current.length>3){lastMessages.current.shift();}if(lastMessages.current.length===3&&lastMessages.current.every(msg=>msg===lastMessages.current[0])){setIsChatBanned(true);setBanTimeLeft(20);banTimerRef.current=setInterval(()=>{setBanTimeLeft(prev=>{if(prev<=1){clearInterval(banTimerRef.current);setIsChatBanned(false);return 0;}return prev-1;});},1000);}setMessage('');setIsButtonDisabled(true);setTimeout(()=>setIsButtonDisabled(false),500);}};const handleChange=e=>{const input=e.target.value;if(input.length<=30){setMessage(input);}};return/*#__PURE__*/_jsxs(\"form\",{className:\"chat-input\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:message,onChange:handleChange,placeholder:isLoggedIn?isChatBanned?`채팅 금지: ${banTimeLeft}초 남음`:\"메시지를 입력하세요 (최대 30자)\":\"로그인 해주세요\",maxLength:30,disabled:!isLoggedIn||isChatBanned,className:isChatBanned?\"chat-banned\":\"\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isButtonDisabled||!isLoggedIn||isChatBanned,children:isLoggedIn?isChatBanned?`${banTimeLeft}초`:\"전송\":\"로그인 해주세요\"})]});}export default ChatInput;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","ChatInput","_ref","onSendMessage","isLoggedIn","message","setMessage","isButtonDisabled","setIsButtonDisabled","isChatBanned","setIsChatBanned","banTimeLeft","setBanTimeLeft","lastMessages","banTimerRef","current","clearInterval","handleSubmit","e","preventDefault","trim","length","push","shift","every","msg","setInterval","prev","setTimeout","handleChange","input","target","value","className","onSubmit","children","type","onChange","placeholder","maxLength","disabled"],"sources":["/home/work/chat/front/src/components/ChatInput.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\n\nfunction ChatInput({ onSendMessage, isLoggedIn }) {\n  const [message, setMessage] = useState('');\n  const [isButtonDisabled, setIsButtonDisabled] = useState(false);\n  const [isChatBanned, setIsChatBanned] = useState(false);\n  const [banTimeLeft, setBanTimeLeft] = useState(0);\n  const lastMessages = useRef([]);\n  const banTimerRef = useRef(null);\n\n  useEffect(() => {\n    return () => {\n      if (banTimerRef.current) {\n        clearInterval(banTimerRef.current);\n      }\n    };\n  }, []);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (message.trim() && message.length <= 30 && isLoggedIn && !isChatBanned) {\n      onSendMessage(message);\n      lastMessages.current.push(message);\n      if (lastMessages.current.length > 3) {\n        lastMessages.current.shift();\n      }\n      if (lastMessages.current.length === 3 && \n          lastMessages.current.every(msg => msg === lastMessages.current[0])) {\n        setIsChatBanned(true);\n        setBanTimeLeft(20);\n        banTimerRef.current = setInterval(() => {\n          setBanTimeLeft(prev => {\n            if (prev <= 1) {\n              clearInterval(banTimerRef.current);\n              setIsChatBanned(false);\n              return 0;\n            }\n            return prev - 1;\n          });\n        }, 1000);\n      }\n      setMessage('');\n      setIsButtonDisabled(true);\n      setTimeout(() => setIsButtonDisabled(false), 500);\n    }\n  };\n\n  const handleChange = (e) => {\n    const input = e.target.value;\n    if (input.length <= 30) {\n      setMessage(input);\n    }\n  };\n\n  return (\n    <form className=\"chat-input\" onSubmit={handleSubmit}>\n      <input\n        type=\"text\"\n        value={message}\n        onChange={handleChange}\n        placeholder={isLoggedIn ? (isChatBanned ? `채팅 금지: ${banTimeLeft}초 남음` : \"메시지를 입력하세요 (최대 30자)\") : \"로그인 해주세요\"}\n        maxLength={30}\n        disabled={!isLoggedIn || isChatBanned}\n        className={isChatBanned ? \"chat-banned\" : \"\"}\n      />\n      <button type=\"submit\" disabled={isButtonDisabled || !isLoggedIn || isChatBanned}>\n        {isLoggedIn ? (isChatBanned ? `${banTimeLeft}초` : \"전송\") : \"로그인 해주세요\"}\n      </button>\n    </form>\n  );\n}\n\nexport default ChatInput;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}