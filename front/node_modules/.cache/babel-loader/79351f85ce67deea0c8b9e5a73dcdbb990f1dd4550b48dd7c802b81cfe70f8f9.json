{"ast":null,"code":"var _jsxFileName = \"/home/work/chat/front/src/components/ChatMessages.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ChatMessages({\n  messages,\n  currentUserId\n}) {\n  _s();\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(scrollToBottom, [messages]);\n\n  // Unicode 문자열을 디코딩하는 함수\n  const decodeUnicode = str => {\n    return str.replace(/\\\\u[\\dA-F]{4}/gi, match => {\n      return String.fromCharCode(parseInt(match.replace(/\\\\u/g, ''), 16));\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-messages\",\n    children: [messages.map((message, index) => {\n      let messageContent, sender, username;\n      if (typeof message === 'string') {\n        try {\n          const parsedMessage = JSON.parse(message);\n          messageContent = parsedMessage.message;\n          sender = parsedMessage.sender;\n          username = parsedMessage.username;\n        } catch (e) {\n          console.error(\"Failed to parse message:\", e);\n          return null;\n        }\n      } else {\n        messageContent = message.message || message.text;\n        sender = message.sender;\n        username = message.username;\n      }\n\n      // System message 처리\n      if (sender === 'system' || message.type === 'system') {\n        messageContent = decodeUnicode(messageContent);\n      }\n      if (!messageContent || messageContent.trim() === '' || messageContent === '내용 없음') {\n        return null;\n      }\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `message ${sender === currentUserId ? 'user' : sender === 'system' ? 'system' : 'other'}`,\n        children: [sender !== currentUserId && sender !== 'system' && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"message-username\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: username || 'Anonymous'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 50\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: messageContent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 13\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 11\n      }, this);\n    }), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: messagesEndRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatMessages, \"0epSoi03NVSoD0I0FiLK4iVNXOA=\");\n_c = ChatMessages;\nexport default ChatMessages;\nvar _c;\n$RefreshReg$(_c, \"ChatMessages\");","map":{"version":3,"names":["React","useEffect","useRef","jsxDEV","_jsxDEV","ChatMessages","messages","currentUserId","_s","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","decodeUnicode","str","replace","match","String","fromCharCode","parseInt","className","children","map","message","index","messageContent","sender","username","parsedMessage","JSON","parse","e","console","error","text","type","trim","fileName","_jsxFileName","lineNumber","columnNumber","ref","_c","$RefreshReg$"],"sources":["/home/work/chat/front/src/components/ChatMessages.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\n\nfunction ChatMessages({ messages, currentUserId }) {\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(scrollToBottom, [messages]);\n\n  // Unicode 문자열을 디코딩하는 함수\n  const decodeUnicode = (str) => {\n    return str.replace(/\\\\u[\\dA-F]{4}/gi, (match) => {\n      return String.fromCharCode(parseInt(match.replace(/\\\\u/g, ''), 16));\n    });\n  };\n\n  return (\n    <div className=\"chat-messages\">\n      {messages.map((message, index) => {\n        let messageContent, sender, username;\n        \n        if (typeof message === 'string') {\n          try {\n            const parsedMessage = JSON.parse(message);\n            messageContent = parsedMessage.message;\n            sender = parsedMessage.sender;\n            username = parsedMessage.username;\n          } catch (e) {\n            console.error(\"Failed to parse message:\", e);\n            return null;\n          }\n        } else {\n          messageContent = message.message || message.text;\n          sender = message.sender;\n          username = message.username;\n        }\n\n        // System message 처리\n        if (sender === 'system' || message.type === 'system') {\n          messageContent = decodeUnicode(messageContent);\n        }\n\n        if (!messageContent || messageContent.trim() === '' || messageContent === '내용 없음') {\n          return null;\n        }\n\n        return (\n          <div \n            key={index} \n            className={`message ${sender === currentUserId ? 'user' : (sender === 'system' ? 'system' : 'other')}`}\n          >\n            {sender !== currentUserId && sender !== 'system' && (\n              <span className=\"message-username\"><strong>{username || 'Anonymous'}</strong> </span>\n            )}\n            <span>{messageContent}</span>\n          </div>\n        );\n      })}\n      <div ref={messagesEndRef} />\n    </div>\n  );\n}\n\nexport default ChatMessages;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjD,SAASC,YAAYA,CAAC;EAAEC,QAAQ;EAAEC;AAAc,CAAC,EAAE;EAAAC,EAAA;EACjD,MAAMC,cAAc,GAAGP,MAAM,CAAC,IAAI,CAAC;EAEnC,MAAMQ,cAAc,GAAGA,CAAA,KAAM;IAAA,IAAAC,qBAAA;IAC3B,CAAAA,qBAAA,GAAAF,cAAc,CAACG,OAAO,cAAAD,qBAAA,uBAAtBA,qBAAA,CAAwBE,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC;EAEDb,SAAS,CAACS,cAAc,EAAE,CAACJ,QAAQ,CAAC,CAAC;;EAErC;EACA,MAAMS,aAAa,GAAIC,GAAG,IAAK;IAC7B,OAAOA,GAAG,CAACC,OAAO,CAAC,iBAAiB,EAAGC,KAAK,IAAK;MAC/C,OAAOC,MAAM,CAACC,YAAY,CAACC,QAAQ,CAACH,KAAK,CAACD,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;IACrE,CAAC,CAAC;EACJ,CAAC;EAED,oBACEb,OAAA;IAAKkB,SAAS,EAAC,eAAe;IAAAC,QAAA,GAC3BjB,QAAQ,CAACkB,GAAG,CAAC,CAACC,OAAO,EAAEC,KAAK,KAAK;MAChC,IAAIC,cAAc,EAAEC,MAAM,EAAEC,QAAQ;MAEpC,IAAI,OAAOJ,OAAO,KAAK,QAAQ,EAAE;QAC/B,IAAI;UACF,MAAMK,aAAa,GAAGC,IAAI,CAACC,KAAK,CAACP,OAAO,CAAC;UACzCE,cAAc,GAAGG,aAAa,CAACL,OAAO;UACtCG,MAAM,GAAGE,aAAa,CAACF,MAAM;UAC7BC,QAAQ,GAAGC,aAAa,CAACD,QAAQ;QACnC,CAAC,CAAC,OAAOI,CAAC,EAAE;UACVC,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEF,CAAC,CAAC;UAC5C,OAAO,IAAI;QACb;MACF,CAAC,MAAM;QACLN,cAAc,GAAGF,OAAO,CAACA,OAAO,IAAIA,OAAO,CAACW,IAAI;QAChDR,MAAM,GAAGH,OAAO,CAACG,MAAM;QACvBC,QAAQ,GAAGJ,OAAO,CAACI,QAAQ;MAC7B;;MAEA;MACA,IAAID,MAAM,KAAK,QAAQ,IAAIH,OAAO,CAACY,IAAI,KAAK,QAAQ,EAAE;QACpDV,cAAc,GAAGZ,aAAa,CAACY,cAAc,CAAC;MAChD;MAEA,IAAI,CAACA,cAAc,IAAIA,cAAc,CAACW,IAAI,CAAC,CAAC,KAAK,EAAE,IAAIX,cAAc,KAAK,OAAO,EAAE;QACjF,OAAO,IAAI;MACb;MAEA,oBACEvB,OAAA;QAEEkB,SAAS,EAAE,WAAWM,MAAM,KAAKrB,aAAa,GAAG,MAAM,GAAIqB,MAAM,KAAK,QAAQ,GAAG,QAAQ,GAAG,OAAQ,EAAG;QAAAL,QAAA,GAEtGK,MAAM,KAAKrB,aAAa,IAAIqB,MAAM,KAAK,QAAQ,iBAC9CxB,OAAA;UAAMkB,SAAS,EAAC,kBAAkB;UAAAC,QAAA,gBAACnB,OAAA;YAAAmB,QAAA,EAASM,QAAQ,IAAI;UAAW;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAS,CAAC,KAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CACrF,eACDtC,OAAA;UAAAmB,QAAA,EAAOI;QAAc;UAAAY,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA,GANxBhB,KAAK;QAAAa,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAOP,CAAC;IAEV,CAAC,CAAC,eACFtC,OAAA;MAAKuC,GAAG,EAAElC;IAAe;MAAA8B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACzB,CAAC;AAEV;AAAClC,EAAA,CA7DQH,YAAY;AAAAuC,EAAA,GAAZvC,YAAY;AA+DrB,eAAeA,YAAY;AAAC,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}