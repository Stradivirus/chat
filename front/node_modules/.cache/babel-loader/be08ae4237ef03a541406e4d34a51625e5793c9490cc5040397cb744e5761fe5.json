{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import ChatPage from'./pages/ChatPage';import AuthModal from'./components/AuthModal';import{useWebSocket}from'./hooks/useWebSocket';import'./styles/base.css';import'./styles/components.css';import'./styles/utilities.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[userCount,setUserCount]=useState(0);const{socket,showSessionExpiredModal,setShowSessionExpiredModal,chatBanTimeLeft,sendMessage}=useWebSocket(user);useEffect(()=>{if(socket){const handleMessage=event=>{const data=JSON.parse(event.data);if(data.type==='user_count'){setUserCount(data.count);}};socket.addEventListener('message',handleMessage);return()=>{socket.removeEventListener('message',handleMessage);};}},[socket]);const handleLoginSuccess=useCallback(userData=>{console.log('Login successful:',userData);setUser(userData);},[]);const handleLogout=()=>{setUser(null);setUserCount(0);if(socket){socket.close(1000,\"Logout\");}};const handleSessionExpired=()=>{setShowSessionExpiredModal(false);handleLogout();};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"main-section\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"main-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\uCC44\\uD305 \\uC560\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\"})}),/*#__PURE__*/_jsx(\"main\",{className:\"main-content\"})]}),/*#__PURE__*/_jsxs(\"aside\",{className:\"side-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"side-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-count\",children:[\"\\uD604\\uC7AC \\uC811\\uC18D\\uC790 \\uC218: \",userCount]}),user&&/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"user-nickname\",children:[user.username,\"\\uB2D8\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-button\",children:\"\\uB85C\\uADF8\\uC544\\uC6C3\"})]})]}),user?/*#__PURE__*/_jsx(ChatPage,{socket:socket,user:user,chatBanTimeLeft:chatBanTimeLeft,sendMessage:sendMessage}):/*#__PURE__*/_jsx(\"div\",{className:\"login-message\",children:\"\\uB85C\\uADF8\\uC778\\uC774 \\uD544\\uC694\\uD569\\uB2C8\\uB2E4.\"})]}),!user&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsx(AuthModal,{onLoginSuccess:handleLoginSuccess})}),showSessionExpiredModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-backdrop\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"session-expired-modal\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uB2E4\\uB978 \\uAE30\\uAE30\\uC5D0\\uC11C \\uB85C\\uADF8\\uC778\\uB418\\uC5B4 \\uB85C\\uADF8\\uC544\\uC6C3 \\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSessionExpired,children:\"\\uD655\\uC778\"})]})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","ChatPage","AuthModal","useWebSocket","jsx","_jsx","jsxs","_jsxs","App","user","setUser","userCount","setUserCount","socket","showSessionExpiredModal","setShowSessionExpiredModal","chatBanTimeLeft","sendMessage","handleMessage","event","data","JSON","parse","type","count","addEventListener","removeEventListener","handleLoginSuccess","userData","console","log","handleLogout","close","handleSessionExpired","className","children","username","onClick","onLoginSuccess"],"sources":["/home/work/chat/front/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport ChatPage from './pages/ChatPage';\nimport AuthModal from './components/AuthModal';\nimport { useWebSocket } from './hooks/useWebSocket';\nimport './styles/base.css';\nimport './styles/components.css';\nimport './styles/utilities.css';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [userCount, setUserCount] = useState(0);\n\n  const {\n    socket,\n    showSessionExpiredModal,\n    setShowSessionExpiredModal,\n    chatBanTimeLeft,\n    sendMessage\n  } = useWebSocket(user);\n\n  useEffect(() => {\n    if (socket) {\n      const handleMessage = (event) => {\n        const data = JSON.parse(event.data);\n        if (data.type === 'user_count') {\n          setUserCount(data.count);\n        }\n      };\n\n      socket.addEventListener('message', handleMessage);\n\n      return () => {\n        socket.removeEventListener('message', handleMessage);\n      };\n    }\n  }, [socket]);\n\n  const handleLoginSuccess = useCallback((userData) => {\n    console.log('Login successful:', userData);\n    setUser(userData);\n  }, []);\n\n  const handleLogout = () => {\n    setUser(null);\n    setUserCount(0);\n    if (socket) {\n      socket.close(1000, \"Logout\");\n    }\n  };\n\n  const handleSessionExpired = () => {\n    setShowSessionExpiredModal(false);\n    handleLogout();\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"main-section\">\n        <header className=\"main-header\">\n          <h1>채팅 애플리케이션</h1>\n        </header>\n        <main className=\"main-content\">\n        \n        </main>\n      </div>\n      <aside className=\"side-container\">\n        <header className=\"side-header\">\n          <div className=\"user-count\">현재 접속자 수: {userCount}</div>\n          {user && (\n            <div className=\"user-info\">\n              <span className=\"user-nickname\">{user.username}님</span>\n              <button onClick={handleLogout} className=\"logout-button\">로그아웃</button>\n            </div>\n          )}\n        </header>\n        {user ? (\n          <ChatPage \n            socket={socket} \n            user={user} \n            chatBanTimeLeft={chatBanTimeLeft}\n            sendMessage={sendMessage}\n          />\n        ) : (\n          <div className=\"login-message\">로그인이 필요합니다.</div>\n        )}\n      </aside>\n      {!user && (\n        <div className=\"modal-backdrop\">\n          <AuthModal \n            onLoginSuccess={handleLoginSuccess}\n          />\n        </div>\n      )}\n      {showSessionExpiredModal && (\n        <div className=\"modal-backdrop\">\n          <div className=\"session-expired-modal\">\n            <p>다른 기기에서 로그인되어 로그아웃 되었습니다.</p>\n            <button onClick={handleSessionExpired}>확인</button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}